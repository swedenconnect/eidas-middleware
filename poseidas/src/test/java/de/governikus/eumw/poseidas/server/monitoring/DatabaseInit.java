package de.governikus.eumw.poseidas.server.monitoring;

import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.HexFormat;
import java.util.List;
import java.util.Locale;

import org.springframework.stereotype.Service;

import de.governikus.eumw.poseidas.server.pki.entities.CertInChain;
import de.governikus.eumw.poseidas.server.pki.entities.CertInChainPK;
import de.governikus.eumw.poseidas.server.pki.entities.KeyArchive;
import de.governikus.eumw.poseidas.server.pki.entities.RequestSignerCertificate;
import de.governikus.eumw.poseidas.server.pki.entities.TerminalPermission;
import de.governikus.eumw.poseidas.server.pki.repositories.CertInChainRepository;
import de.governikus.eumw.poseidas.server.pki.repositories.KeyArchiveRepository;
import de.governikus.eumw.poseidas.server.pki.repositories.RequestSignerCertificateRepository;
import de.governikus.eumw.poseidas.server.pki.repositories.TerminalPermissionRepository;
import lombok.RequiredArgsConstructor;
import lombok.SneakyThrows;


@RequiredArgsConstructor
@Service
public class DatabaseInit
{

  private final RequestSignerCertificateRepository requestSignerCertificateRepository;

  private final TerminalPermissionRepository terminalPermissionRepository;

  private final CertInChainRepository certInChainRepository;

  private final KeyArchiveRepository keyArchiveRepository;

  private static final byte[] RSC1_PRIVATE_KEY = HexFormat.of()
                                                          .parseHex("3082024B0201003081EC06072A8648CE3D02013081E0020101302C06072A8648CE3D0101022100A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377304404207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9042026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B60441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997022100A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A7020101048201553082015102010104200400E969D280BF754D3E3D6AA0E0FF13414B4A3E4ED5B36D041B7EDCA9C452EBA081E33081E0020101302C06072A8648CE3D0101022100A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377304404207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9042026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B60441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997022100A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A7020101A14403420004348B76803321BEAB5FEA25E805C2523D9153DF1FE26D90202B9AE7BA605FC76E3346BCD3FE3344C1D103CAB6B422E57C0BCC1F749D544073B4560A43AADFA044");

  private static final byte[] RSC1_X509_REQUEST_SIGNER_CERTIFICATE = HexFormat.of()
                                                                              .parseHex("30820249308201F0A003020102020601777182AF33300A06082A8648CE3D040302303E3117301506035504030C0E444565494441534445525343303131233021060355040B0C1A52657175657374205369676E6572204365727469666963617465301E170D3231303230353039323532355A170D3234303230353039323532355A303E3117301506035504030C0E444565494441534445525343303131233021060355040B0C1A52657175657374205369676E6572204365727469666963617465308201333081EC06072A8648CE3D02013081E0020101302C06072A8648CE3D0101022100A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377304404207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9042026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B60441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997022100A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A702010103420004348B76803321BEAB5FEA25E805C2523D9153DF1FE26D90202B9AE7BA605FC76E3346BCD3FE3344C1D103CAB6B422E57C0BCC1F749D544073B4560A43AADFA044300A06082A8648CE3D040302034700304402203CBD1D1E020D3CAACDE051A1185557FB3F6B64654DA6C773613D60F80002DE8A022040EFE9EE954B8B64376FCE44654D4CD3B6FD44D6634FDBB0C57C970142D713C8");

  private static final byte[] RSC2_PRIVATE_KEY = HexFormat.of()
                                                          .parseHex("3082024B0201003081EC06072A8648CE3D02013081E0020101302C06072A8648CE3D0101022100A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377304404207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9042026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B60441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997022100A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A702010104820155308201510201010420A185E7377BE81DDAEA62F6B758B5044C34170F5FA7463B7CF22A03238E0D63A2A081E33081E0020101302C06072A8648CE3D0101022100A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377304404207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9042026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B60441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997022100A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A7020101A144034200047C7E751CA1CD0B7C165B923CC8467FC402CE803E15AEE5827F4D3064038617E7882137110BDDB1E60DB76E5F5E4E7EC629AA195364D6E048A8459E9003817E51");

  private static final byte[] RSC2_X509_REQUEST_SIGNER_CERTIFICATE = HexFormat.of()
                                                                              .parseHex("30820245308201ECA0030201020206017771830481300A06082A8648CE3D040302303C3115301306035504030C0C54657374527363525343303131233021060355040B0C1A52657175657374205369676E6572204365727469666963617465301E170D3231303230353039323534375A170D3234303230353039323534375A303C3115301306035504030C0C54657374527363525343303131233021060355040B0C1A52657175657374205369676E6572204365727469666963617465308201333081EC06072A8648CE3D02013081E0020101302C06072A8648CE3D0101022100A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377304404207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9042026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B60441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997022100A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A7020101034200047C7E751CA1CD0B7C165B923CC8467FC402CE803E15AEE5827F4D3064038617E7882137110BDDB1E60DB76E5F5E4E7EC629AA195364D6E048A8459E9003817E51300A06082A8648CE3D0403020347003044022034F2BB72C3CF05F3BB5A1A14E50F5E5EDF2166556C3FE4803EA62697217AFAD902200FC9427DEBBC9F166EFE98ABEA294DD3D5A4EAF4A66A34B381E205956568A260");

  private static final byte[] DEFAULT_DEFECT_LIST = HexFormat.of()
                                                             .parseHex("3082036F06092A864886F70D010702A08203603082035C020103310F300D060960864801650304020405003020060804007F0007030105A0140412301002010006096086480165030402013100A08201F9308201F53082017CA003020102020115300A06082A8648CE3D040303304C310C300A060355040B1303627369310D300B060355040A130462756E64310B30090603550406130244453120301E060355040313176549442D53657276657220546573746265642043534341301E170D3230303730373037323033335A170D3336313231303038323033335A305A310C300A060355040B1303627369310D300B060355040A130462756E64310B3009060355040613024445312E302C060355040313256549442D536572766572205465737462656420446566656374204C697374205369676E6572307A301406072A8648CE3D020106092B240303020801010B03620004646EEC9159323DA947729782C7AD0B40E99B57B3FF45D47E14C2F37089AC3F15C11BCF4221F7C65461D08E1B910580254DAD1EE40A869765E86DA438EA5C46F2FE509942A9D61952BB98A225D3BFF4059CC15460C36AAAEAD0C0DB3C43A3AF0FA320301E300E0603551D0F0101FF040403020780300C0603551D130101FF04023000300A06082A8648CE3D04030303670030640230188E141DBCA8B41A55BD17741734F0F7C4B57886AAD48C68C7CDD0EF1FEF9626762C0CE691589D4B5A3BA85E1A48702B023007FA67E81B53CE7E3D63FF196CF0DF2A69EBC24AF2615232D9D62F8A168FFDAE99CCF895FF70689475D839CF15DC287F31820125308201210201013051304C310C300A060355040B1303627369310D300B060355040A130462756E64310B30090603550406130244453120301E060355040313176549442D53657276657220546573746265642043534341020115300D06096086480165030402040500A046301706092A864886F70D010903310A060804007F0007030105302B06092A864886F70D010904311E041C260CB9027E558126E2F6780192FB9A232DE92CC908F5ECE16CDB21BF300A06082A8648CE3D0403010466306402306163A6CD49F5A9695DE33C1A11177B61C86A5FE9912A14EF87E3E697A03B10F926E01E50B9C719D8686E1E9F26CBF98402301B009AD96B84525DDEFC4D10AFC3639D28013F6CD50DFBA6EEA0438ABC1D0562C2E9D63003BC87AF7BABB22A9DCE762D");

  private static final byte[] DEFAULT_CVC_DESCRIPTION = HexFormat.of()
                                                                 .parseHex("3081A6060A04007F00070301030101A1090C07736563756E6574A3140C126549442D5365727665722054657374626564A41A131868747470733A2F2F736F6D652E746573742E75726C2E6465A5130C114356205465726D73206F66205573616765A746314404205C6FCAC6857D69B469B8E8E523B656338BDDA1AC43DEA739E0510C862901D06D042071B89F97689425CCAD573F4754D74BAAFDBB95980D9135605EED4BF29781674C");

  private static final byte[] DEFAULT_MASTER_LIST = HexFormat.of()
                                                             .parseHex("3082055906092A864886F70D010702A082054A30820546020103310F300D06096086480165030402040500308202090606678108010102A08201FD048201F9308201F5020100318201EE308201EA30820171A003020102020101300A06082A8648CE3D040303304C310C300A060355040B1303627369310D300B060355040A130462756E64310B30090603550406130244453120301E060355040313176549442D53657276657220546573746265642043534341301E170D3230303730373037323033335A170D3336313231303038323033335A304C310C300A060355040B1303627369310D300B060355040A130462756E64310B30090603550406130244453120301E060355040313176549442D53657276657220546573746265642043534341307A301406072A8648CE3D020106092B240303020801010B0362000442CB8FE6AFC9CA3596BB5EC9463FAA23DDABD9FF8F89E372A22C5E30B1A505FFFCD38A2AE794C2A69F3D16D099024C6C06EB8F1C79C7783D5A75AD4A1223231174D879404361B18E8CC59998653A00115ED7440226CE9504BA1C8C3AA5705AA2A3233021300E0603551D0F0101FF04040302018E300F0603551D130101FF040530030101FF300A06082A8648CE3D040303036700306402303E2F195BA966B2832732DF28FD52417BEAD5E76D607C0BE66887FC204810F7333BC2E8018749B3BDF34B12A2C29B319A02304628050AF925BA61055F42748F3C937AC71F372E5703D8B45BA0311D1D57EBC70A9D2C4B71FACD6F4E7703F4A2DF3D8DA08201F9308201F53082017CA00302010202010B300A06082A8648CE3D040303304C310C300A060355040B1303627369310D300B060355040A130462756E64310B30090603550406130244453120301E060355040313176549442D53657276657220546573746265642043534341301E170D3230303730373037323033335A170D3336313231303038323033335A305A310C300A060355040B1303627369310D300B060355040A130462756E64310B3009060355040613024445312E302C060355040313256549442D5365727665722054657374626564204D6173746572204C697374205369676E6572307A301406072A8648CE3D020106092B240303020801010B036200047ECBF31F11764699E13D2C047A0EC99C1D7486427E52CEA5D1AF46360567EC6A8EC9990A79193BE7A7B8815D5D88F0DD642ACE081ECE0A6E5090ADAA9CD0D5D0B1F12C5851C8746A19CE7F898A5A322F50AEFB1545567259B592ADD567C679DEA320301E300E0603551D0F0101FF040403020780300C0603551D130101FF04023000300A06082A8648CE3D040303036700306402306ED772118AAD3540BFAA25E24807AFF74B5BF1E4A1BDE9D7AC170195788812C4DA096D7D9B50E1E6E97C3043E4D64824023046967546606577BFDA0FE4EE21DB626CF734F11B3A2C58C201488D85B7D81153C6D33B76D58102ACEB7D4AC2DE6328C131820124308201200201013051304C310C300A060355040B1303627369310D300B060355040A130462756E64310B30090603550406130244453120301E060355040313176549442D5365727665722054657374626564204353434102010B300D06096086480165030402040500A044301506092A864886F70D01090331080606678108010102302B06092A864886F70D010904311E041C61384DB19B25EB6D1F3A3B9F238639A20A45DA157ED13CE72824D4EC300A06082A8648CE3D04030104673065023039C38BB4CB3F420885CE3DBAF87B3E2971ADFB554BEA36F2AE5F66FA7A6F9365E00CCA4A9A032CE91014AEE534AA72D902310080637A80993B001E0E7601CAA67831C35E81072F4A264D1679A8AB28AAC9014A03B16A08FC7B5C523D5FF675AE23549E");

  private static final byte[] DEFAULT_RI_KEY1 = HexFormat.of()
                                                         .parseHex("7F4982011D060A04007F000702020502038120A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E537782207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9832026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B68441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F0469978520A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A78641049D14EF6176DA095E390DC58B9048DFFC0AC3A8530ADBF24C7197664F3A86F0614D05E9F0B67A8377A45D121A375BC9570883C20994A6ACE06B1F5DDABDE1C3D9870101");

  private static final byte[] DEFAULT_SECTOR_ID = HexFormat.of()
                                                           .parseHex("1E13733F6F45FBC724DD1FF2A107DCE8EF5E28144FFE758AA2285EEA26E8F9F2");

  private static final byte[] CVC_TP1 = HexFormat.of()
                                                 .parseHex("7F218201487F4E8201005F290100420E44454553544456314130303030317F494F060A04007F00070202020203864104727753D5EB3597EB6D17FDD72D9218C3D7C6694BFB9E77FD221E4EEF39D17A96A4AFF225D1A383CD83D8D8444837DB0F394A587C427D44DBCB4AB9C2ABFA7EDA5F201044454553545445524D314630303030327F4C12060904007F000703010202530500011198045F25060200000700075F2406030400030106655E732D060904007F0007030103018020885675B2AB976500E4B836D1D250011D1070C025BC8FD204157960F95B0B5569732D060904007F00070301030280201E13733F6F45FBC724DD1FF2A107DCE8EF5E28144FFE758AA2285EEA26E8F9F25F37406036F7D5D5014242885DAEEACAA85983B0F973376331C1381FFA4FC1DB81CC6E9F20E2439CD88427114D41F78FB8B6F4F10E4EACF5822FEEE6B397F911F277C9");

  private static final byte[] CVC_DESCRIPTION_TP1 = HexFormat.of()
                                                             .parseHex("3082024B0201003081EC06072A8648CE3D02013081E0020101302C06072A8648CE3D0101022100A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377304404207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9042026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B60441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997022100A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A7020101048201553082015102010104201963D37879A78F27FDFE60B4B0FE39CC48BB24DDD9B3DA12D2BDAA1D1E5A407FA081E33081E0020101302C06072A8648CE3D0101022100A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377304404207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9042026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B60441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997022100A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A7020101A14403420004727753D5EB3597EB6D17FDD72D9218C3D7C6694BFB9E77FD221E4EEF39D17A96A4AFF225D1A383CD83D8D8444837DB0F394A587C427D44DBCB4AB9C2ABFA7EDA");

  private static final byte[] CVC_TP2 = HexFormat.of()
                                                 .parseHex("7F218201487F4E8201005F290100420E44454553544456314130303030317F494F060A04007F00070202020203864104104D8910F658459E7D14E1F3E41EF56516AE9810EAFBDD2F89DB466D1A04536633C5013799F2E8F6764FCD39C2D9001968EBAE232968870535B4C2BF06A4CAE45F201044454553545445524D314330303030327F4C12060904007F000703010202530500000000385F25060200000700075F2406030400030106655E732D060904007F0007030103018020885675B2AB976500E4B836D1D250011D1070C025BC8FD204157960F95B0B5569732D060904007F00070301030280201E13733F6F45FBC724DD1FF2A107DCE8EF5E28144FFE758AA2285EEA26E8F9F25F37400EC6E3D99D93375B4E121BD770BC783BAE6B57F466CF917F2FC7898BF4118A6365829C19A8ED2EC579D7667ACF8B849AC932CB939179FC9C19A28400B6C24B22");

  private static final byte[] CVC_DESCRIPTION_TP2 = HexFormat.of()
                                                             .parseHex("3082024B0201003081EC06072A8648CE3D02013081E0020101302C06072A8648CE3D0101022100A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377304404207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9042026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B60441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997022100A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A70201010482015530820151020101042076EB0B01715F42371B5D8C2C9ECF2E00D418BA271411AD8851BFF608D6C4F7D6A081E33081E0020101302C06072A8648CE3D0101022100A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377304404207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9042026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B60441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997022100A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A7020101A14403420004104D8910F658459E7D14E1F3E41EF56516AE9810EAFBDD2F89DB466D1A04536633C5013799F2E8F6764FCD39C2D9001968EBAE232968870535B4C2BF06A4CAE4");

  private static final byte[] CVC_TP3 = HexFormat.of()
                                                 .parseHex("7F2182016B7F4E8201235F290100420E44454553544456314130303030317F494F060A04007F000702020202038641048F40522D66F8B948BD7AC225D61C381E100276A2C4031D907D58BD4168310E5D30B39681731B5EE5FFE50E643B28D2BCAF2F79752A3974FD6DBE9B3B014889005F201044454553545445524D314430303030327F4C12060904007F0007030102025305000000003C5F25060200000700075F2406030400030106658180732D060904007F0007030103018020885675B2AB976500E4B836D1D250011D1070C025BC8FD204157960F95B0B5569734F060904007F00070301030280201E13733F6F45FBC724DD1FF2A107DCE8EF5E28144FFE758AA2285EEA26E8F9F28120E5A377772D5AD0109005725B0E05598A8CA12C1EC44FAF34F22D5FF60F8D31DA5F3740403A3B525A328FA2AF1ECFE4C0A59D4A67CD1441E81EF7375307C86795ADCAB788ED67A5F2DFE68E74F2D4E1B04C34B35C3850D8D4316AD9AEFBF1443B366343");

  private static final byte[] CVC_DESCRIPTION_TP3 = HexFormat.of()
                                                             .parseHex("3082024B0201003081EC06072A8648CE3D02013081E0020101302C06072A8648CE3D0101022100A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377304404207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9042026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B60441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997022100A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A7020101048201553082015102010104207B6037F29BB48FDB8C52E1F464870E0DC683F32507F79FF663CC3CD812F613D5A081E33081E0020101302C06072A8648CE3D0101022100A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377304404207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9042026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B60441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997022100A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A7020101A144034200048F40522D66F8B948BD7AC225D61C381E100276A2C4031D907D58BD4168310E5D30B39681731B5EE5FFE50E643B28D2BCAF2F79752A3974FD6DBE9B3B01488900");

  private static final byte[] CVC_TP4 = HexFormat.of()
                                                 .parseHex("7F218201487F4E8201005F290100420E44454553544456314130303030317F494F060A04007F0007020202020386410414756835047351E10572C4B3C28FA92EABEADC5266D79D218D1492A75F7A7A7F363C63878E576AB94F380369180ADBBC78EF30D458073B564F97A2A1021F16BD5F201044454553545445524D314130303030327F4C12060904007F00070301020253053C0FF3FFFF5F25060200000700075F2406030400030106655E732D060904007F0007030103018020885675B2AB976500E4B836D1D250011D1070C025BC8FD204157960F95B0B5569732D060904007F00070301030280201E13733F6F45FBC724DD1FF2A107DCE8EF5E28144FFE758AA2285EEA26E8F9F25F3740A84F22AA8E60D12679ACE56D41750A24090A8A8A4F04D5FD1CDA7B1179C16FF03EF734097EFFA28B193972EF263356B845853201548FBEBB954DD4A5BEBB07EC");

  private static final byte[] CVC_DESCRIPTION_TP4 = HexFormat.of()
                                                             .parseHex("3082024B0201003081EC06072A8648CE3D02013081E0020101302C06072A8648CE3D0101022100A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377304404207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9042026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B60441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997022100A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A7020101048201553082015102010104207BA027A1ED03A962FBA9B283227C8F8D3309563385DCDB79953DB8BAA492F897A081E33081E0020101302C06072A8648CE3D0101022100A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377304404207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9042026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B60441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997022100A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A7020101A1440342000414756835047351E10572C4B3C28FA92EABEADC5266D79D218D1492A75F7A7A7F363C63878E576AB94F380369180ADBBC78EF30D458073B564F97A2A1021F16BD");

  private static final byte[] CVC_TP5 = HexFormat.of()
                                                 .parseHex("7F218201487F4E8201005F290100420E44454553544456314130303030317F494F060A04007F0007020202020386410483DE15CB2CDA1380DF962A5079CD3A047B0DBAB67703F5A1F99D30504E4B3A583F0E1390913125980F6B30CB0A4DC8A7D5991785EDC542FCC94BDDB797699A685F201044454553545445524D314230303030327F4C12060904007F0007030102025305000000103F5F25060200000700075F2406030400030106655E732D060904007F0007030103018020885675B2AB976500E4B836D1D250011D1070C025BC8FD204157960F95B0B5569732D060904007F00070301030280201E13733F6F45FBC724DD1FF2A107DCE8EF5E28144FFE758AA2285EEA26E8F9F25F3740A57E66F62D7E16B1A79A6E626D8B164790998844BACC1FC2E321FA7E372CE8AD36643E69FB41320823B17DBC08F83097DE25D632A7CC5ABD19458459C1066701");

  private static final byte[] CVC_DESCRIPTION_TP5 = HexFormat.of()
                                                             .parseHex("3082024B0201003081EC06072A8648CE3D02013081E0020101302C06072A8648CE3D0101022100A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377304404207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9042026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B60441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997022100A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A70201010482015530820151020101042047A8727B613507922FB9E5149A7C94922A79067982979C4ADDE4D6F99DA63B50A081E33081E0020101302C06072A8648CE3D0101022100A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E5377304404207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9042026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B60441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F046997022100A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A7020101A1440342000483DE15CB2CDA1380DF962A5079CD3A047B0DBAB67703F5A1F99D30504E4B3A583F0E1390913125980F6B30CB0A4DC8A7D5991785EDC542FCC94BDDB797699A68");

  private static final byte[] CERT_IN_CHAIN_DEFAULT_DATA = HexFormat.of()
                                                                    .parseHex("7F218201B87F4E8201705F290100420F4445455354435643413130303030317F4982011D060A04007F000702020202038120A9FB57DBA1EEA9BC3E660A909D838D726E3BF623D52620282013481D1F6E537782207D5A0975FC2C3057EEF67530417AFFE7FB8055C126DC5C6CE94A4B44F330B5D9832026DC5C6CE94A4B44F330B5D9BBD77CBF958416295CF7E1CE6BCCDC18FF8C07B68441048BD2AEB9CB7E57CB2C4B482FFC81B7AFB9DE27E1E3BD23C23A4453BD9ACE3262547EF835C3DAC4FD97F8461A14611DC9C27745132DED8E545C1D54C72F0469978520A9FB57DBA1EEA9BC3E660A909D838D718C397AA3B561A6F7901E0E82974856A78641049E16FE3FAAF89083A0FA63FE2540CA7FEB90D9BB8C948935807D578BF04BCDA81D1DC3B39687E038BA669A3FFD40E38777BE7B98B4E3B20853448D8115FC09E18701015F200F4445455354435643413130303030317F4C12060904007F0007030102025305FE1FFFFFFF5F25060106000400015F24060302000900045F37406848C8F28D0050BE72F0C0C6A84E138E518C19C19CC8B3231CEFB2BDB16304C871612BA6A798BAF9B0DFB3562E5176D319441EDABD6BB52D988932E1B5EF27FE");

  private static final byte[] CERT_IN_CHAIN_DEFAULT_DATA_2 = HexFormat.of()
                                                                      .parseHex("7F2181E67F4E819F5F290100420F4445455354435643413130303030317F494F060A04007F000702020202038641049235AC225F0F681F4C2C7507547556FC81A62F5FF48A82B2693B52628DB6FFA7382B05DAAE2B325845184DF1CACBDE891566136921F98F63019168B1CF00ACC45F200E44454553544456314130303030317F4C12060904007F0007030102025305BE1FFFFFFF5F25060200000700075F24060304000301065F37409196AC3A78168D736C5D09A5ADCE597BC4FAA62A668DD4CC8E27713B6307DE07042B8DDF878F9DF5B8E8F4F235E87940FC67577324966EAB1D1665A8C2833BD3");

  private static final byte[] CVC_BYTES_KEY_ARCHIVE_1 = HexFormat.of()
                                                                 .parseHex("7F218201487F4E8201005F290100420E44454553544456314130303030317F494F060A04007F000702020202038641042870C032B9FC9F7CAA5A93C8E5611D9594CAA1B706D11322C434CF806C9540C46C8C7E7FC188E496C14260B071ABA516969FCE507FCEA10A08CE20718FBAE08B5F201044454553545445524D314630303030317F4C12060904007F000703010202530500011198045F25060200000700075F2406030400030106655E732D060904007F0007030103018020885675B2AB976500E4B836D1D250011D1070C025BC8FD204157960F95B0B5569732D060904007F00070301030280201E13733F6F45FBC724DD1FF2A107DCE8EF5E28144FFE758AA2285EEA26E8F9F25F374083EB7AFD4B6E5BDE18611E98A56D4A28D95B0DA6095DA8889F955BC238BF778274A6B3BF094A4BF06E0CDE1B9FA48EECD2C1F2755F65DAB1241DFB94F65B851F");

  private static final byte[] CVC_BYTES_KEY_ARCHIVE_2 = HexFormat.of()
                                                                 .parseHex("7F218201487F4E8201005F290100420E44454553544456314130303030317F494F060A04007F0007020202020386410469D30244A9EE4086DF0B235AE19F30C99AB89826FAF7660CD5D8522F00FB390944F5778CB97D3EF19E69CFBF0629C89A12990DA39BDA817321B49068C49357D65F201044454553545445524D314330303030317F4C12060904007F000703010202530500000000385F25060200000700075F2406030400030106655E732D060904007F0007030103018020885675B2AB976500E4B836D1D250011D1070C025BC8FD204157960F95B0B5569732D060904007F00070301030280201E13733F6F45FBC724DD1FF2A107DCE8EF5E28144FFE758AA2285EEA26E8F9F25F37408261D0DC4447CF69F92663A75D4073201FA3B18570ED54B2B4562D434AA071A27F2EEAAC2FF2259A37EABD5BBBE400339C8B30180FA78A60E37095070766BA1C");

  private static final byte[] CVC_BYTES_KEY_ARCHIVE_3 = HexFormat.of()
                                                                 .parseHex("7F2182016B7F4E8201235F290100420E44454553544456314130303030317F494F060A04007F0007020202020386410454137E552159CAA5D5619E0F7F8AB2FB67A3BA3F3C7890C2BEC5FB213E0C18171B8F20BC17EDCF07DC841964D14B70988973854E5173414BDBA6169242338EC85F201044454553545445524D314430303030317F4C12060904007F0007030102025305000000003C5F25060200000700075F2406030400030106658180732D060904007F0007030103018020885675B2AB976500E4B836D1D250011D1070C025BC8FD204157960F95B0B5569734F060904007F00070301030280201E13733F6F45FBC724DD1FF2A107DCE8EF5E28144FFE758AA2285EEA26E8F9F28120E5A377772D5AD0109005725B0E05598A8CA12C1EC44FAF34F22D5FF60F8D31DA5F374051B802F28E7420631BAC701EC5C10AD1F3EAAA120638C64D71E4CAF2BAF13B0A156039AE124A4D8CB9C1DCB45436A64105115CAA3E7716023BFAEFBD29901325");

  private static final byte[] CVC_BYTES_KEY_ARCHIVE_4 = HexFormat.of()
                                                                 .parseHex("7F218201487F4E8201005F290100420E44454553544456314130303030317F494F060A04007F000702020202038641041C3C71E970243A718EF169B08D7FDDD0C2DFACAD6CA920E94CF75C17305A17241B6C4FAD9DBFD0ADDDABB6380DB9D1878145ED9E90FF41E5959F230C35EDD45B5F201044454553545445524D314130303030317F4C12060904007F00070301020253053C0FF3FFFF5F25060200000700075F2406030400030106655E732D060904007F0007030103018020885675B2AB976500E4B836D1D250011D1070C025BC8FD204157960F95B0B5569732D060904007F00070301030280201E13733F6F45FBC724DD1FF2A107DCE8EF5E28144FFE758AA2285EEA26E8F9F25F374087AE90F8C42FC110C0DF6E7A34B65A912BDAD8FAD70D7116F9E2BE508D4029F559E247FDD259F5DEC2C171E46E033C8C2B29FB7E4B665A535C6ECB8CEFA85B2E");

  private static final byte[] CVC_BYTES_KEY_ARCHIVE_5 = HexFormat.of()
                                                                 .parseHex("7F218201487F4E8201005F290100420E44454553544456314130303030317F494F060A04007F000702020202038641046F3F3388C95F7F0259C1DA66E761838C38B4353563A81B0A8965AEB76467AE02434AB877924A4611B05F5FDAD7EC77729AC6543FF97DA2AA1BC3BE6B65E513A45F201044454553545445524D314230303030317F4C12060904007F0007030102025305000000103F5F25060200000700075F2406030400030106655E732D060904007F0007030103018020885675B2AB976500E4B836D1D250011D1070C025BC8FD204157960F95B0B5569732D060904007F00070301030280201E13733F6F45FBC724DD1FF2A107DCE8EF5E28144FFE758AA2285EEA26E8F9F25F37405B548F16AC0C6E728182E5213A3C6F64FED3F3E3DC2576D53D7CC187E5BAFEE379D3A106084129AF2A8EEDB4C57ECF6F7186B23AA8ED94FE5D08B0A93E258039");

  private static final byte[] CVC_BYTES_KEY_ARCHIVE_6 = HexFormat.of()
                                                                 .parseHex("7F218201487F4E8201005F290100420E44454553544456314130303030317F494F060A04007F00070202020203864104A3DEE494EC9328CC419A5814FDA45F9C4648FB5A1A7A423EE1564FA1A4204FB626B88EDFA1C3894DFEB141BC92B26EF1976E5C196BACE48AA131FC432DF6FF535F201044454553545445524D314730303030317F4C12060904007F000703010202530500000010005F25060200000700075F2406030400030106655E732D060904007F0007030103018020885675B2AB976500E4B836D1D250011D1070C025BC8FD204157960F95B0B5569732D060904007F00070301030280201E13733F6F45FBC724DD1FF2A107DCE8EF5E28144FFE758AA2285EEA26E8F9F25F37401970AC9ECF4CFABDFC339C3079C3E2CA33007C7DEEE5538DB5CEDE1018B15931117A1EB46583D39F645C5521B5364703A93DAF2175CFF40806053D42B038AB26");

  private static final Long DEFAULT_BLACKLIST_VERSION = 34L;

  /**
   * Create and save the test data for SNMP testcases.
   */
  public void initializeSNMPDatabase()
  {
    requestSignerCertificateRepository.saveAll(initializeSNMPRequestSignerCertificate());
    terminalPermissionRepository.saveAll(initializeSNMPTerminalPermission());
    certInChainRepository.saveAll(initializeSNMPCertInChain());
    keyArchiveRepository.saveAll(initializeSNMPKeyArchive());
  }

  private List<RequestSignerCertificate> initializeSNMPRequestSignerCertificate()
  {
    ArrayList<RequestSignerCertificate> list = new ArrayList<>();

    RequestSignerCertificate requestSignerCertificate1 = new RequestSignerCertificate();
    CertInChainPK certInChainPK1 = new CertInChainPK("A", 1);
    requestSignerCertificate1.setKey(certInChainPK1);
    requestSignerCertificate1.setPrivateKey(RSC1_PRIVATE_KEY);
    requestSignerCertificate1.setX509RequestSignerCertificate(RSC1_X509_REQUEST_SIGNER_CERTIFICATE);
    list.add(requestSignerCertificate1);

    RequestSignerCertificate requestSignerCertificate2 = new RequestSignerCertificate();
    CertInChainPK certInChainPK2 = new CertInChainPK("B", 1);
    requestSignerCertificate2.setKey(certInChainPK2);
    requestSignerCertificate2.setPrivateKey(RSC2_PRIVATE_KEY);
    requestSignerCertificate2.setX509RequestSignerCertificate(RSC2_X509_REQUEST_SIGNER_CERTIFICATE);
    list.add(requestSignerCertificate2);

    return list;
  }


  @SneakyThrows
  private List<TerminalPermission> initializeSNMPTerminalPermission()
  {
    ArrayList<TerminalPermission> list = new ArrayList<>();
    SimpleDateFormat formatter = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss.SSS", Locale.ENGLISH);

    Date defaultNotOnOrAfter = formatter.parse("2034-03-17 01:00:00.000");

    // TP 1
    list.add(createTerminalPermission("F",
                                      formatter.parse("2021-01-26 13:25:58.503"),
                                      CVC_TP1,
                                      DEFAULT_CVC_DESCRIPTION,
                                      CVC_DESCRIPTION_TP1,
                                      DEFAULT_DEFECT_LIST,
                                      formatter.parse("2021-01-26 12:44:19.268"),
                                      DEFAULT_MASTER_LIST,
                                      formatter.parse("2021-01-26 12:44:19.266"),
                                      defaultNotOnOrAfter,
                                      DEFAULT_RI_KEY1,
                                      null,
                                      DEFAULT_SECTOR_ID,
                                      null,
                                      null,
                                      null,
                                      null));

    // TP 2
    list.add(createTerminalPermission("C",
                                      formatter.parse("2021-01-26 12:42:43.539"),
                                      CVC_TP2,
                                      DEFAULT_CVC_DESCRIPTION,
                                      CVC_DESCRIPTION_TP2,
                                      DEFAULT_DEFECT_LIST,
                                      formatter.parse("2021-01-26 12:42:44.817"),
                                      DEFAULT_MASTER_LIST,
                                      formatter.parse("2021-01-26 12:42:44.814"),
                                      defaultNotOnOrAfter,
                                      DEFAULT_RI_KEY1,
                                      null,
                                      DEFAULT_SECTOR_ID,
                                      null,
                                      null,
                                      null,
                                      null));

    // TP 3
    list.add(createTerminalPermission("D",
                                      formatter.parse("2021-01-26 12:43:03.157"),
                                      CVC_TP3,
                                      DEFAULT_CVC_DESCRIPTION,
                                      CVC_DESCRIPTION_TP3,
                                      DEFAULT_DEFECT_LIST,
                                      formatter.parse("2021-01-26 12:43:05.27"),
                                      DEFAULT_MASTER_LIST,
                                      formatter.parse("2021-01-26 12:43:05.268"),
                                      defaultNotOnOrAfter,
                                      DEFAULT_RI_KEY1,
                                      null,
                                      DEFAULT_SECTOR_ID,
                                      null,
                                      null,
                                      null,
                                      null));

    // TP 4
    list.add(createTerminalPermission("A",
                                      formatter.parse("2021-01-26 12:43:23.931Z"),
                                      CVC_TP4,
                                      DEFAULT_CVC_DESCRIPTION,
                                      CVC_DESCRIPTION_TP4,
                                      DEFAULT_DEFECT_LIST,
                                      formatter.parse("2021-01-26 12:43:25.306Z"),
                                      DEFAULT_MASTER_LIST,
                                      formatter.parse("2021-01-26 12:43:25.306Z"),
                                      defaultNotOnOrAfter,
                                      DEFAULT_RI_KEY1,
                                      "DEeIDASDE",
                                      DEFAULT_SECTOR_ID,
                                      1,
                                      "A",
                                      null,
                                      null));

    // TP 5
    list.add(createTerminalPermission("B",
                                      formatter.parse("2021-01-26 12:43:41.118"),
                                      CVC_TP5,
                                      DEFAULT_CVC_DESCRIPTION,
                                      CVC_DESCRIPTION_TP5,
                                      DEFAULT_DEFECT_LIST,
                                      formatter.parse("2021-01-26 12:43:42.353"),
                                      DEFAULT_MASTER_LIST,
                                      formatter.parse("2021-01-26 12:43:42.352"),
                                      defaultNotOnOrAfter,
                                      DEFAULT_RI_KEY1,
                                      "TestRsc",
                                      DEFAULT_SECTOR_ID,
                                      null,
                                      null,
                                      1,
                                      "B"));

    // TP 6 empty
    list.add(new TerminalPermission("G"));

    return list;
  }

  private List<CertInChain> initializeSNMPCertInChain()
  {
    ArrayList<CertInChain> list = new ArrayList<>();

    list.add(new CertInChain(terminalPermissionRepository.getReferenceById("F"), new CertInChainPK("F", 1),
                             CERT_IN_CHAIN_DEFAULT_DATA));
    list.add(new CertInChain(terminalPermissionRepository.getReferenceById("F"), new CertInChainPK("F", 0),
                             CERT_IN_CHAIN_DEFAULT_DATA_2));
    list.add(new CertInChain(terminalPermissionRepository.getReferenceById("C"), new CertInChainPK("C", 1),
                             CERT_IN_CHAIN_DEFAULT_DATA));
    list.add(new CertInChain(terminalPermissionRepository.getReferenceById("C"), new CertInChainPK("C", 0),
                             CERT_IN_CHAIN_DEFAULT_DATA_2));
    list.add(new CertInChain(terminalPermissionRepository.getReferenceById("D"), new CertInChainPK("D", 1),
                             CERT_IN_CHAIN_DEFAULT_DATA));
    list.add(new CertInChain(terminalPermissionRepository.getReferenceById("D"), new CertInChainPK("D", 0),
                             CERT_IN_CHAIN_DEFAULT_DATA_2));
    list.add(new CertInChain(terminalPermissionRepository.getReferenceById("A"), new CertInChainPK("A", 1),
                             CERT_IN_CHAIN_DEFAULT_DATA));
    list.add(new CertInChain(terminalPermissionRepository.getReferenceById("A"), new CertInChainPK("A", 0),
                             CERT_IN_CHAIN_DEFAULT_DATA_2));
    list.add(new CertInChain(terminalPermissionRepository.getReferenceById("B"), new CertInChainPK("B", 1),
                             CERT_IN_CHAIN_DEFAULT_DATA));
    list.add(new CertInChain(terminalPermissionRepository.getReferenceById("B"), new CertInChainPK("B", 0),
                             CERT_IN_CHAIN_DEFAULT_DATA_2));
    list.add(new CertInChain(terminalPermissionRepository.getReferenceById("G"), new CertInChainPK("G", 1),
                             CERT_IN_CHAIN_DEFAULT_DATA));
    list.add(new CertInChain(terminalPermissionRepository.getReferenceById("G"), new CertInChainPK("G", 0),
                             CERT_IN_CHAIN_DEFAULT_DATA_2));
    return list;
  }


  private List<KeyArchive> initializeSNMPKeyArchive()
  {
    ArrayList<KeyArchive> list = new ArrayList<>();

    String defaultKeyName = "DEESTTERM1F00001";

    list.add(new KeyArchive(defaultKeyName, CVC_BYTES_KEY_ARCHIVE_1));
    list.add(new KeyArchive(defaultKeyName, CVC_BYTES_KEY_ARCHIVE_2));
    list.add(new KeyArchive(defaultKeyName, CVC_BYTES_KEY_ARCHIVE_3));
    list.add(new KeyArchive(defaultKeyName, CVC_BYTES_KEY_ARCHIVE_4));
    list.add(new KeyArchive(defaultKeyName, CVC_BYTES_KEY_ARCHIVE_5));
    list.add(new KeyArchive(defaultKeyName, CVC_BYTES_KEY_ARCHIVE_6));
    return list;
  }

  private TerminalPermission createTerminalPermission(String refId,
                                                      Date blackListStoreDate,
                                                      byte[] cvc,
                                                      byte[] cvcDescription,
                                                      byte[] cvcPrivateKey,
                                                      byte[] defectList,
                                                      Date defectListStoreDate,
                                                      byte[] masterList,
                                                      Date masterListStoreDate,
                                                      Date notOnOrAfter,
                                                      byte[] riKey1,
                                                      String rscChr,
                                                      byte[] sectorId,
                                                      Integer currentRequestSignerCertPosInChain,
                                                      String currentRequestSignerCertRefId,
                                                      Integer pendingRequestSignerCertPosInChain,
                                                      String pendingRequestSignerCertRefId)
  {
    TerminalPermission terminalPermission = new TerminalPermission(refId);

    terminalPermission.setBlackListStoreDate(blackListStoreDate);
    // Version identical for all TP
    terminalPermission.setBlackListVersion(DEFAULT_BLACKLIST_VERSION);

    terminalPermission.setCvc(cvc);
    terminalPermission.setCvcDescription(cvcDescription);
    terminalPermission.setCvcPrivateKey(cvcPrivateKey);

    terminalPermission.setDefectList(defectList);
    terminalPermission.setDefectListStoreDate(defectListStoreDate);

    terminalPermission.setMasterList(masterList);
    terminalPermission.setMasterListStoreDate(masterListStoreDate);

    terminalPermission.setNotOnOrAfter(notOnOrAfter);
    terminalPermission.setRiKey1(riKey1);
    if (null != rscChr)
    {
      terminalPermission.setRscChr(rscChr);
    }
    terminalPermission.setSectorID(sectorId);

    if (null != currentRequestSignerCertPosInChain && null != currentRequestSignerCertRefId)
    {
      CertInChainPK currentCertInChainPK = new CertInChainPK(currentRequestSignerCertRefId,
                                                             currentRequestSignerCertPosInChain);
      terminalPermission.setCurrentRequestSignerCertificate(requestSignerCertificateRepository.findById(currentCertInChainPK)
                                                                                              .orElseThrow());
    }

    if (null != pendingRequestSignerCertPosInChain && null != pendingRequestSignerCertRefId)
    {
      CertInChainPK pendingCertInChainPK = new CertInChainPK(pendingRequestSignerCertRefId,
                                                             pendingRequestSignerCertPosInChain);
      terminalPermission.setPendingRequestSignerCertificate(requestSignerCertificateRepository.findById(pendingCertInChainPK)
                                                                                              .orElseThrow());
    }

    return terminalPermission;
  }
}
